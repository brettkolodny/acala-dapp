(this["webpackJsonp@acala-dapp/apps"]=this["webpackJsonp@acala-dapp/apps"]||[]).push([[7],{2407:function(e,t,r){e.exports={root:"SwapConsole_root__3G5EI",inputAreaRoot:"SwapConsole_inputAreaRoot__376vf",title:"SwapConsole_title__3TDaU",main:"SwapConsole_main__oklzd",inputFields:"SwapConsole_inputFields__23FPQ",inputFieldsInner:"SwapConsole_inputFieldsInner__3w_no",swapBtn:"SwapConsole_swapBtn__3XHdA",txBtn:"SwapConsole_txBtn__1ctYw",addon:"SwapConsole_addon__2fmH5",swapInfoRoot:"SwapConsole_swapInfoRoot__1vqid",info:"SwapConsole_info__24iir",swapRoute:"SwapConsole_swapRoute__38Mhe"}},2442:function(e,t,r){e.exports={root:"TagInput_root__3uRV9",primary:"TagInput_primary__Tp6Iu",clickable:"TagInput_clickable__28EM9",error:"TagInput_error__2ELmQ",input:"TagInput_input__2OQKl"}},2443:function(e,t,r){e.exports={root:"SlippageInputArea_root__2w92S",title:"SlippageInputArea_title__26KMB"}},2444:function(e,t,r){e.exports={headerCell:"AllMarkets_headerCell___2Iue"}},2450:function(e,t,r){"use strict";r.r(t);var a=r(0),n=r.n(a),c=r(8),u=r(31),l=r(32),o=r(283),i=r(9),s=r(3),p=r(2407),m=r.n(p),b=r(5),d=r(167),y=r(56),f=r(603),O=function(e){return{base:Object(s.convertToFixed18)(e.base),other:Object(s.convertToFixed18)(e.other)}},C=Object(a.createContext)({}),g=Object(a.memo)((function(e){var t=e.children,r=Object(i.e)().api,l=Object(i.w)(),o=l.isInitialized,p=l.setEnd,m=Object(i.i)().dexBaseCurrency,g=Object(a.useRef)(),j=Object(a.useMemo)((function(){var e=r.consts.dex.enabledCurrencyIds.toArray();return e.push(m),e}),[r.consts.dex.enabledCurrencyIds,m]),v=Object(a.useMemo)((function(){return j.slice()}),[j]),x=Object(a.useMemo)((function(){return j[0]}),[j]),E=Object(a.useMemo)((function(){return r.consts.dex.getExchangeFee}),[r]),_=Object(a.useState)(.005),N=Object(b.a)(_,2),h=N[0],F=N[1],S=Object(a.useState)(0),w=Object(b.a)(S,2),T=w[0],I=w[1],k=Object(a.useState)({supplyCurrency:"",supplySize:0,targetCurrency:"",targetSize:0}),M=Object(b.a)(k,2),R=M[0],z=M[1],q=Object(a.useCallback)((function(e,t){g.current&&g.current.unsubscribe(),Object(u.ab)(e,m)&&!Object(u.ab)(t,m)&&(g.current=r.derive.dex.pool(t).subscribe((function(r){z({supplyCurrency:e,supplySize:Object(s.convertToFixed18)(r.base).toNumber(),targetCurrency:t,targetSize:Object(s.convertToFixed18)(r.other).toNumber()})}))),Object(u.ab)(t,m)&&!Object(u.ab)(e,m)&&(g.current=r.derive.dex.pool(e).subscribe((function(r){z({supplyCurrency:e,supplySize:Object(s.convertToFixed18)(r.other).toNumber(),targetCurrency:t,targetSize:Object(s.convertToFixed18)(r.base).toNumber()})}))),Object(u.ab)(t,m)||Object(u.ab)(e,m)||(g.current=Object(d.b)([r.derive.dex.pool(e),r.derive.dex.pool(t)]).subscribe((function(r){var a=Object(b.a)(r,2),n=a[0],c=a[1];z({supplyCurrency:e,supplySize:Object(s.convertToFixed18)(n.other).toNumber(),targetCurrency:t,targetSize:Object(s.convertToFixed18)(c.other).toNumber()})}))),Object(u.ab)(e,m)&&Object(u.ab)(t,m)&&z({supplyCurrency:e,supplySize:0,targetCurrency:t,targetSize:0})}),[r.derive,m,z]),B=Object(a.useCallback)((function(e,t,a,n){return Object(d.b)([r.derive.dex.pool(e),r.derive.dex.pool(t)]).pipe(Object(y.a)((function(r){var c=Object(b.a)(r,2),u=c[0],l=c[1];return u&&l?!e.eq(m)&&t.eq(m)?Object(s.calcSupplyInOtherToBase)(s.Fixed18.fromNatural(a),O(u),Object(s.convertToFixed18)(E),s.Fixed18.fromNatural(n||0)).toNumber():e.eq(m)&&!t.eq(m)?Object(s.calcSupplyInBaseToOther)(s.Fixed18.fromNatural(a),O(l),Object(s.convertToFixed18)(E),s.Fixed18.fromNatural(n||0)).toNumber():e.eq(m)||t.eq(m)?0:Object(s.calcSupplyInOtherToOther)(s.Fixed18.fromNatural(a),O(u),O(l),Object(s.convertToFixed18)(E),s.Fixed18.fromNatural(n||0)).toNumber():0})),Object(f.a)())}),[r.derive,m,E]),P=Object(a.useCallback)((function(e,t,a,n){return Object(d.b)([r.derive.dex.pool(e),r.derive.dex.pool(t)]).pipe(Object(y.a)((function(r){var c=Object(b.a)(r,2),u=c[0],l=c[1];return u&&l?!e.eq(m)&&t.eq(m)?Object(s.calcTargetInOtherToBase)(s.Fixed18.fromNatural(a),O(u),Object(s.convertToFixed18)(E),s.Fixed18.fromNatural(n||0)).toNumber():e.eq(m)&&!t.eq(m)?Object(s.calcTargetInBaseToOther)(s.Fixed18.fromNatural(a),O(l),Object(s.convertToFixed18)(E),s.Fixed18.fromNatural(n||0)).toNumber():e.eq(m)||t.eq(m)?0:Object(s.calcTargetInOtherToOther)(s.Fixed18.fromNatural(a),O(u),O(l),Object(s.convertToFixed18)(E),s.Fixed18.fromNatural(n||0)).toNumber():0})),Object(f.a)())}),[r.derive,m,E]);return Object(a.useEffect)((function(){R.supplyCurrency&&!o&&p()}),[o,R,p]),Object(a.useEffect)((function(){q(x,m)}),[x,m,q]),n.a.createElement(C.Provider,{value:{calcSupply:B,calcTarget:P,dexBaseCurrency:m,isInitialized:o,pool:R,priceImpact:T,setCurrency:q,setPriceImpact:I,setSlippage:F,slippage:h,supplyCurrencies:j,targetCurrencies:v}},o?t:n.a.createElement(c.z,null))}));g.displayName="SwapProvider";var j=function(e){var t=e.basePriceRate,r=e.current,c=e.target,l=Object(i.D)(r),o=Object(i.D)(c),p=Object(a.useMemo)((function(){return l&&o?l.div(o):s.Fixed18.ZERO}),[l,o]);return n.a.createElement(u.q,{color:t.isLessThan(p)?"error":"success",pair:[{balance:s.Fixed18.fromNatural(1),currency:r},{balance:p,currency:c}],pairSymbol:"\u2248"})},v=function(e){var t=e.pool,r=e.supply,c=e.target,l=Object(a.useContext)(C).setPriceImpact,o=Object(i.m)(t.supplyCurrency,t.targetCurrency),s=Object(i.m)(t.supplyCurrency,t.targetCurrency,r,c),p=Object(a.useMemo)((function(){var e=Math.abs(s.sub(o).div(o).toNumber());return e>1?1:e}),[s,o]);return Object(a.useEffect)((function(){l(p)}),[p,l]),p<.001?null:n.a.createElement("p",null,"Price Impact is ",n.a.createElement(u.t,{color:p<.01?"success":p>.05?"error":void 0,data:p}))},x=function(e){var t=e.pool,r=Object(i.i)().dexBaseCurrency,c=Object(i.e)().api,l=Object(a.useMemo)((function(){return!Object(u.ab)(t.supplyCurrency,r)&&!Object(u.ab)(t.targetCurrency,r)}),[t,r]);return n.a.createElement("div",{className:m.a.info},"Transaction Fee is ",n.a.createElement(u.t,{data:Object(s.convertToFixed18)(c.consts.dex.getExchangeFee).mul(l?s.Fixed18.fromNatural(2):s.Fixed18.fromNatural(1))}))},E=Object(a.memo)((function(e){var t=e.supply,r=e.supplyCurrency,l=e.target,o=e.targetCurrency,p=Object(a.useContext)(C),b=p.pool,d=p.slippage,y=Object(a.useMemo)((function(){var e=s.Fixed18.fromNatural(l).div(s.Fixed18.fromNatural(1+d));return e.isNaN()?0:e}),[l,d]),f=Object(i.m)(b.supplyCurrency,b.targetCurrency);return n.a.createElement("div",{className:m.a.swapInfoRoot},n.a.createElement("p",null,"You are selling",n.a.createElement(c.L,null,n.a.createElement(u.q,{balance:t,currency:r})),"for at least",n.a.createElement(c.L,null,n.a.createElement(u.q,{balance:y,currency:o}))),n.a.createElement("p",null,"Current Market Price is ",n.a.createElement(j,{basePriceRate:f,current:r,target:o})),n.a.createElement(x,{pool:b}),n.a.createElement(v,{pool:b,supply:t,target:l}))}));E.displayName="SwapInfo";var _=r(26),N=r(41),h=r(13),F=r(454),S=r(2442),w=r.n(S),T=function(e){var t=e.className,r=e.error,a=e.label,c=Object(N.a)(e,["className","error","label"]);return n.a.createElement("div",{className:Object(h.a)(t,w.a.root,Object(_.a)({},w.a.error,r))},n.a.createElement(F.a,Object.assign({},c,{className:w.a.input})),a?n.a.createElement("span",null,a):null)},I=r(2443),k=r.n(I),M=function(){var e=Object(a.useContext)(C),t=e.setSlippage,r=e.slippage,u=Object(a.useState)(0),l=Object(b.a)(u,2),o=l[0],i=l[1],s=Object(a.useMemo)((function(){return[.001,.005,.01]}),[]),p=Object(a.useCallback)((function(e){t(e)}),[t]),m=Object(a.useCallback)((function(e){return"".concat(100*e,"%").concat(e===s[1]?" (suggested)":"")}),[s]),d=Object(a.useCallback)((function(e){var r=Number(e);i(r),t(r/100)}),[t,i]);return n.a.createElement("div",{className:k.a.root}," ",n.a.createElement("p",{className:k.a.title},"Limit addtion price slippage"),n.a.createElement(c.M,null,s.map((function(e){return n.a.createElement(c.L,{color:r===e?"primary":"white",key:"suggest-".concat(e),onClick:function(){return p(e)}},m(e))})),n.a.createElement(T,{id:"custom",label:"%",max:50,min:0,name:"custom",onChange:d,placeholder:"Custom",value:o})))},R=function(e){var t=e.addon,r=e.currencies,l=e.error,o=e.inputName,i=e.maxInput,s=e.onChange,p=e.onTokenChange,b=e.showMax,d=void 0!==b&&b,y=e.title,f=e.token,O=e.value,C=Object(a.useCallback)((function(){s&&i&&s(i.toNumber())}),[i,s]);return n.a.createElement("div",{className:m.a.inputAreaRoot},n.a.createElement("div",{className:m.a.title},y,n.a.createElement(c.i,{condition:!!i},n.a.createElement("p",null,"Max:",n.a.createElement(u.q,{balance:i,currency:f})))),n.a.createElement(u.c,{className:m.a.input,currencies:r,enableTokenSelect:!0,error:l,name:o,onChange:s,onMax:C,onTokenChange:p,showMaxBtn:d,token:f,value:O}),t)};function z(e){var t=e.onClick;return n.a.createElement(c.s,{className:m.a.swapBtn,color:"primary",icon:"swap",onClick:t,size:"large",type:"border"})}var q=Object(a.memo)((function(){var e=Object(a.useContext)(C),t=e.calcSupply,r=e.calcTarget,p=e.pool,b=e.priceImpact,d=e.setCurrency,y=e.slippage,f=e.supplyCurrencies,O=e.targetCurrencies,g=Object(i.g)(p.supplyCurrency),j=Object(i.u)({supply:{currency:p.supplyCurrency,max:p.supplySize,min:0,type:"balance"},target:{max:p.targetSize,min:0,type:"number"}}),v=Object(o.a)({initialValues:{supply:"",target:""},onSubmit:l.noop,validate:j}),x=Object(a.useCallback)((function(){d(p.targetCurrency,p.supplyCurrency),v.resetForm()}),[d,p.targetCurrency,p.supplyCurrency,v]),_=Object(a.useCallback)((function(e){r(p.supplyCurrency,p.targetCurrency,e).subscribe((function(e){Object(c.R)((function(){return v.setFieldValue("target",e)}))})),Object(c.R)((function(){return v.setFieldValue("supply",e)}))}),[r,p.supplyCurrency,p.targetCurrency,v]),N=Object(a.useCallback)((function(e){t(p.supplyCurrency,p.targetCurrency,e).subscribe((function(e){Object(c.R)((function(){return v.setFieldValue("supply",e)}))})),Object(c.R)((function(){return v.setFieldValue("target",e)}))}),[t,p.supplyCurrency,p.targetCurrency,v]),h=Object(a.useCallback)((function(e){d(e,p.targetCurrency),t(e,p.targetCurrency,v.values.target).subscribe((function(e){e&&Object(c.R)((function(){return v.setFieldValue("supply",e)}))}))}),[t,v,p.targetCurrency,d]),F=Object(a.useCallback)((function(e){d(p.supplyCurrency,e),r(p.supplyCurrency,e,v.values.supply).subscribe((function(e){e&&Object(c.R)((function(){return v.setFieldValue("target",e)}))}))}),[r,v,p.supplyCurrency,d]),S=Object(a.useMemo)((function(){return!(!v.errors.supply&&!v.errors.target)||(!v.values.target||!v.values.supply)}),[v]),w=Object(a.useMemo)((function(){return g?Object(s.convertToFixed18)(g).min(s.Fixed18.fromNatural(p.supplySize)):void 0}),[g,p.supplySize]),T=Object(a.useMemo)((function(){return[p.supplyCurrency,Object(u.Z)(v.values.supply),p.targetCurrency,s.Fixed18.fromNatural(v.values.target).div(s.Fixed18.fromNatural(1+y)).innerToString()]}),[v,p,y]);return n.a.createElement(c.f,{className:m.a.root,padding:!1},n.a.createElement("div",{className:m.a.main},n.a.createElement("div",{className:m.a.inputFields},n.a.createElement("div",{className:m.a.inputFieldsInner},n.a.createElement(R,{currencies:f,error:v.errors.supply,inputName:"supply",maxInput:w,onChange:_,onTokenChange:h,showMax:!0,title:"Pay With",token:p.supplyCurrency,value:v.values.supply}),n.a.createElement(z,{onClick:x}),n.a.createElement(R,{currencies:O,error:v.errors.target,inputName:"target",onChange:N,onTokenChange:F,title:"Receive (Estimate)",token:p.targetCurrency,value:v.values.target})),n.a.createElement("div",{className:m.a.addon},n.a.createElement("p",null,"Dex Price"),n.a.createElement(u.i,{supply:p.supplyCurrency,supplyAmount:v.values.supply,target:p.targetCurrency}))),n.a.createElement(u.O,{className:m.a.txBtn,color:b>.05?"danger":"primary",disabled:S,method:"swapCurrency",onSuccess:v.resetForm,params:T,section:"dex",size:"large"},b>.05?"Swap Anyway":"Swap")),n.a.createElement(E,{supply:v.values.supply,supplyCurrency:p.supplyCurrency,target:v.values.target,targetCurrency:p.targetCurrency}),n.a.createElement(M,null))}));q.displayName="SwapConsole";var B=r(2444),P=r.n(B),A=function(){var e=Object(a.useContext)(C),t=e.dexBaseCurrency,r=e.supplyCurrencies.filter((function(e){return e.toString()!==t.toString()})),l=[{align:"left",render:function(e){return n.a.createElement(u.G,{currency:e,icon:!0})},title:"Token Pair",width:1},{align:"left",render:function(e){return n.a.createElement(u.i,{supply:e})},title:"Dex Price",width:3},{align:"left",render:function(e){return n.a.createElement(u.k,{token:e})},title:"Pool Size",width:3}];return n.a.createElement(c.C,{title:"All Markets"},n.a.createElement(c.f,{padding:!1},n.a.createElement(c.J,{config:l,data:r,headerCellClassName:P.a.headerCell,showHeader:!0})))},V=function(e){var t=e.supply,r=e.supplyCurrency,a=e.target,c=e.targetCurrency;return n.a.createElement(u.q,{pair:[{balance:s.Fixed18.fromParts(t),currency:r},{balance:s.Fixed18.fromParts(a),currency:c}],pairSymbol:"->"})},L=function(){var e=Object(a.useRef)([{align:"left",dataIndex:"hash",render:function(e){return n.a.createElement(u.r,{hash:e})},title:"Tx Hash",width:1},{align:"left",dataIndex:"params",render:function(e){return n.a.createElement(V,{supply:e[1],supplyCurrency:e[0],target:e[3],targetCurrency:e[2]})},title:"Action",width:3},{align:"left",dataIndex:"time",render:function(e){return n.a.createElement(u.u,{time:e})},title:"When",width:1},{align:"right",dataIndex:"success",render:function(e){return n.a.createElement(c.E,{success:e})},title:"Result",width:1}]);return n.a.createElement(u.d,{config:e.current,method:"swap_currency",section:"dex"})};t.default=function(){return n.a.createElement(g,null,n.a.createElement(c.y,null,n.a.createElement(c.y.Title,{title:"Swap"}),n.a.createElement(c.y.Content,null,n.a.createElement(c.r,{container:!0},n.a.createElement(c.r,{item:!0},n.a.createElement(u.T,null)),n.a.createElement(c.r,{item:!0},n.a.createElement(q,null)),n.a.createElement(c.r,{item:!0},n.a.createElement(A,null)),n.a.createElement(c.r,{item:!0},n.a.createElement(L,null))))))}}}]);
//# sourceMappingURL=7.9cb0b822.chunk.js.map